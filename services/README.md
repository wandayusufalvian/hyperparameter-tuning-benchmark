all functions used in this research